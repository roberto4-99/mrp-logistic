<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MRP Logistic | Profile</title>

  <style>
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      color:#fff;
      background:
        radial-gradient(900px 500px at 10% 10%, rgba(99,102,241,.25), transparent 55%),
        radial-gradient(900px 500px at 90% 15%, rgba(59,130,246,.18), transparent 60%),
        radial-gradient(900px 500px at 70% 90%, rgba(34,197,94,.12), transparent 55%),
        linear-gradient(180deg,#071026,#040816);
      overflow-x:hidden;
    }

    :root{
      --glass: rgba(255,255,255,.07);
      --glass2: rgba(255,255,255,.10);
      --border: rgba(255,255,255,.14);
      --muted: rgba(255,255,255,.72);
      --muted2: rgba(255,255,255,.60);
      --shadow: 0 30px 90px rgba(0,0,0,.55);
    }

    .wrap{
      max-width:980px;
      margin:auto;
      padding:18px;
      padding-bottom:120px;
    }

    .toast{
      position:fixed;
      bottom:22px;
      left:50%;
      transform:translateX(-50%);
      background:rgba(2,6,23,.92);
      border:1px solid rgba(255,255,255,.14);
      box-shadow:0 18px 60px rgba(0,0,0,.55);
      padding:12px 16px;
      border-radius:999px;
      display:none;
      z-index:9999;
      max-width:92vw;
      text-align:center;
      backdrop-filter: blur(12px);
    }
    .toast.show{display:block}

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-top:6px;
      margin-bottom:14px;
    }

    .back{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border-radius:999px;
      color:#fff;
      text-decoration:none;
      font-weight:800;
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.14);
      backdrop-filter: blur(10px);
      transition:transform .12s ease, background .2s ease, border-color .2s ease;
      user-select:none;
      white-space:nowrap;
    }
    .back:hover{background:rgba(255,255,255,.12);border-color:rgba(255,255,255,.22);transform:translateY(-1px)}
    .back:active{transform:translateY(1px)}
    .arrow{font-size:16px;opacity:.9}

    .card{
      background:var(--glass);
      border:1px solid var(--border);
      border-radius:26px;
      padding:18px;
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
      box-shadow: var(--shadow);
    }

    .hero{
      position:relative;
      overflow:hidden;
      margin-bottom:14px;
    }
    .hero::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(600px 220px at 30% 20%, rgba(99,102,241,.35), transparent 60%),
        radial-gradient(520px 220px at 80% 40%, rgba(59,130,246,.28), transparent 62%),
        radial-gradient(420px 220px at 50% 90%, rgba(34,197,94,.18), transparent 60%);
      filter: blur(18px);
      opacity:.9;
      pointer-events:none;
    }
    .heroInner{
      position:relative;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      text-align:center;
      gap:12px;
      padding:18px 10px 10px;
    }

    .avatar{
      width:82px;height:82px;border-radius:50%;
      background:
        radial-gradient(circle at 30% 25%, rgba(255,255,255,.25), rgba(255,255,255,.06) 55%),
        linear-gradient(135deg, rgba(99,102,241,.75), rgba(59,130,246,.65));
      border:1px solid rgba(255,255,255,.22);
      box-shadow:
        0 0 0 8px rgba(255,255,255,.06),
        0 0 32px rgba(99,102,241,.35),
        0 0 28px rgba(59,130,246,.25);
      display:flex;align-items:center;justify-content:center;
      font-weight:900;font-size:22px;
      user-select:none;
    }

    .name{
      font-family: ui-serif, Georgia, "Times New Roman", Times, serif;
      font-size:26px;
      font-weight:900;
      margin:0;
    }
    .subtitle{
      margin:0;
      font-size:13px;
      color:var(--muted);
      line-height:1.6;
      max-width:620px;
    }

    .metaRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:center;
      margin-top:6px;
    }
    .chip{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border-radius:999px;
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.14);
      color:#fff;
      font-weight:900;
      font-size:12px;
      backdrop-filter: blur(10px);
    }
    .chip span{opacity:.92;font-weight:800}
    .chip b{font-weight:900}

    .grid{
      display:grid;
      gap:14px;
      margin-top:14px;
    }
    .grid.two{grid-template-columns:1fr 1fr}
    @media(max-width:820px){.grid.two{grid-template-columns:1fr}}

    .caps{display:grid;gap:12px}

    .cap{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:14px;
      border-radius:22px;
      background:var(--glass2);
      border:1px solid rgba(255,255,255,.12);
      backdrop-filter: blur(16px);
      box-shadow: 0 18px 55px rgba(0,0,0,.25);
    }
    .capLeft{
      display:flex;align-items:center;gap:12px;min-width:0;
    }
    .iconBubble{
      width:44px;height:44px;border-radius:16px;
      display:flex;align-items:center;justify-content:center;
      font-size:18px;font-weight:900;
      border:1px solid rgba(255,255,255,.16);
      box-shadow: 0 12px 30px rgba(0,0,0,.25);
      flex:0 0 auto;
    }
    .iconPoints{background:rgba(16,185,129,.16); box-shadow:0 0 26px rgba(16,185,129,.18)}
    .iconDone{background:rgba(59,130,246,.16); box-shadow:0 0 26px rgba(59,130,246,.18)}
    .iconTasks{background:rgba(99,102,241,.16); box-shadow:0 0 26px rgba(99,102,241,.20)}

    .capText{min-width:0}
    .capText .t{font-size:12px;color:var(--muted2);font-weight:800;margin-bottom:2px}
    .capText .v{font-size:20px;font-weight:900;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:420px}

    .cta{
      width:100%;
      border:none;
      cursor:pointer;
      padding:14px 16px;
      border-radius:999px;
      font-weight:900;
      font-size:14px;
      color:#020617;
      background: linear-gradient(135deg, #8b5cf6, #3b82f6);
      box-shadow:
        0 16px 45px rgba(59,130,246,.22),
        0 14px 40px rgba(139,92,246,.18);
      transition: transform .12s ease, filter .2s ease;
    }
    .cta:hover{filter: brightness(1.05)}
    .cta:active{transform: translateY(1px) scale(.99)}

    .infoCard{
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      border-radius:24px;
      padding:16px;
      backdrop-filter: blur(16px);
      box-shadow: 0 18px 55px rgba(0,0,0,.22);
    }
    .infoTitle{font-size:14px;font-weight:900;margin:0 0 8px 0}

    .row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      padding:10px 0;
      border-bottom:1px solid rgba(255,255,255,.10);
    }
    .row:last-child{border-bottom:none}
    .k{font-size:12px;color:var(--muted2);font-weight:800;white-space:nowrap}
    .val{
      font-size:13px;
      font-weight:900;
      text-align:left;
      direction:ltr;
      opacity:.95;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width:58%;
    }
    .copy{
      border:none;cursor:pointer;
      padding:10px 12px;border-radius:14px;
      background:rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.16);
      color:#fff;font-weight:900;
      transition: transform .12s ease, background .2s ease, border-color .2s ease;
      white-space:nowrap;
    }
    .copy:hover{background:rgba(255,255,255,.14); border-color:rgba(255,255,255,.22)}
    .copy:active{transform:translateY(1px)}

    /* âœ… OFFERS (Ù…Ø¨Ø§Ø´Ø±Ø© ØªØ­Øª Ø§Ù„Ù‡ÙŠØ±Ùˆ) */
    .offersCard{
      margin-top:14px;
      background:rgba(255,255,255,.07);
      border:1px solid rgba(255,255,255,.14);
      border-radius:26px;
      padding:16px;
      backdrop-filter: blur(18px);
      box-shadow: 0 20px 70px rgba(0,0,0,.35);
    }
    .offersHead{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      margin-bottom:12px;
    }
    .offersTitle{
      font-size:16px;
      font-weight:900;
    }
    .offersSub{
      font-size:12px;
      color:var(--muted);
      margin-top:4px;
    }
    .offersGrid{
      display:grid;
      grid-template-columns:1fr 1fr 1fr;
      gap:12px;
    }
    @media(max-width:900px){
      .offersGrid{grid-template-columns:1fr}
    }
    .offer{
      background:rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.14);
      border-radius:20px;
      padding:14px;
      box-shadow:0 16px 45px rgba(0,0,0,.20);
    }
    .offer.highlight{
      background:linear-gradient(135deg,rgba(34,197,94,.16),rgba(59,130,246,.16));
      border-color:rgba(59,130,246,.35);
    }
    .offerTop{font-weight:900;font-size:14px}
    .offerMid{margin-top:8px;font-size:13px;color:rgba(255,255,255,.92)}
    .offerMid b{font-size:16px}
    .offerBot{margin-top:6px;font-size:12px;color:var(--muted)}
    .note{
      margin-top:12px;
      font-size:12px;
      color:var(--muted);
      padding-top:10px;
      border-top:1px solid rgba(255,255,255,.10);
      line-height:1.6;
    }

    /* NAV */
    .nav{
      position:fixed;left:0;right:0;bottom:0;
      background:rgba(0,0,0,.65);
      border-top:1px solid rgba(255,255,255,.14);
      backdrop-filter:blur(12px);
      z-index:999;
    }
    .nav .inner{
      max-width:1100px;margin:auto;
      display:flex;justify-content:space-around;align-items:center;
      padding:10px;
      gap:10px;
    }
    .navbtn{
      display:flex;flex-direction:column;align-items:center;justify-content:center;
      gap:4px;min-width:90px;
      padding:10px 12px;border-radius:16px;
      color:#fff;text-decoration:none;font-weight:900;
      background:rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.18);
      cursor:pointer;
      transition:transform .12s ease, background .2s ease, border-color .2s ease;
      user-select:none;
    }
    .navbtn .icoNav{font-size:20px;line-height:1}
    .navbtn .txtNav{font-size:11px;opacity:.9}
    .navbtn:hover{background:rgba(255,255,255,.16);border-color:rgba(255,255,255,.28);transform:translateY(-1px)}
    .navbtn:active{transform:translateY(1px) scale(.98)}
    .navbtn.active{
      background:linear-gradient(135deg,#22c55e,#3b82f6);
      border-color:transparent;
      box-shadow:0 10px 26px rgba(0,0,0,.25);
      color:#020617;
    }
    .navbtn.active .txtNav{opacity:1}

    .navbtn.danger{
      background:rgba(239,68,68,.20);
      border-color:rgba(239,68,68,.35);
    }
    .navbtn.danger:hover{
      background:rgba(239,68,68,.28);
      border-color:rgba(239,68,68,.5);
    }
    .nav form{margin:0}
    .nav button.navbtn{width:auto}
  </style>
</head>
<body>

<div class="toast" id="toast"></div>

<div class="wrap">
  <div class="topbar">
    <a class="back" href="/home"><span class="arrow">â†</span><span>Ø±Ø¬ÙˆØ¹</span></a>
    <div style="opacity:.75;font-weight:900;font-size:12px;">Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</div>
  </div>

  <!-- HERO -->
  <div class="card hero">
    <div class="heroInner">
      <div class="avatar" id="avatar">U</div>
      <h2 class="name" id="fullName">...</h2>
      <p class="subtitle" id="subLine">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øªâ€¦</p>

      <div class="metaRow">
        <div class="chip">ğŸ†” <span>ID</span> <b id="uid">â€”</b></div>
        <div class="chip">ğŸ›¡ï¸ <span>Ø§Ù„Ø­Ø§Ù„Ø©</span> <b id="status">Active</b></div>
      </div>
    </div>
  </div>

  <!-- âœ… OFFERS Ù…Ø¨Ø§Ø´Ø±Ø© ØªØ­Øª Ø§Ù„Ù‡ÙŠØ±Ùˆ -->
  <div class="offersCard">
    <div class="offersHead">
      <div>
        <div class="offersTitle">ğŸ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</div>
        <div class="offersSub">Ø§Ø³ØªØ«Ù…Ø± Ø±ØµÙŠØ¯Ùƒ ÙˆØ§Ø±Ø¨Ø­ Ù†Ù‚Ø§Ø· ÙŠÙˆÙ…ÙŠØ§Ù‹</div>
      </div>
      <div class="chip">ğŸ’± <span>ÙƒÙ„</span> <b>10 Ù†Ù‚Ø§Ø·</b> = <b>1$</b></div>
    </div>

    <div class="offersGrid">
      <div class="offer">
        <div class="offerTop">ğŸ’µ Ø´Ø­Ù† 5 Ø¯ÙˆÙ„Ø§Ø±</div>
        <div class="offerMid">ğŸ¯ Ø±Ø¨Ø­ ÙŠÙˆÙ…ÙŠ: <b>30 Ù†Ù‚Ø·Ø©</b></div>
        <div class="offerBot">â‰ˆ 3 Ø¯ÙˆÙ„Ø§Ø± / ÙŠÙˆÙ…</div>
      </div>

      <div class="offer">
        <div class="offerTop">ğŸ’µ Ø´Ø­Ù† 10 Ø¯ÙˆÙ„Ø§Ø±</div>
        <div class="offerMid">ğŸ¯ Ø±Ø¨Ø­ ÙŠÙˆÙ…ÙŠ: <b>60 Ù†Ù‚Ø·Ø©</b></div>
        <div class="offerBot">â‰ˆ 6 Ø¯ÙˆÙ„Ø§Ø± / ÙŠÙˆÙ…</div>
      </div>

      <div class="offer highlight">
        <div class="offerTop">ğŸ’µ Ø´Ø­Ù† 20 Ø¯ÙˆÙ„Ø§Ø±</div>
        <div class="offerMid">ğŸ¯ Ø±Ø¨Ø­ ÙŠÙˆÙ…ÙŠ: <b>125 Ù†Ù‚Ø·Ø©</b></div>
        <div class="offerBot">â‰ˆ 12.5 Ø¯ÙˆÙ„Ø§Ø± / ÙŠÙˆÙ…</div>
      </div>
    </div>

    <div class="note">
      â„¹ï¸ Ø§Ù„Ø¹Ø±ÙˆØ¶ ØªÙˆØ¶ÙŠØ­ÙŠØ© ÙÙ‚Ø· Ø¯Ø§Ø®Ù„ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©. Ø¥Ø°Ø§ Ø¨ØºÙŠØª Ù†Ø®Ù„ÙŠÙ‡Ø§ Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹/Ø§Ù„Ø³Ø­Ø¨ Ø¯Ø§Ø®Ù„ Home Ù†Ù‚Ø§Ø¯Ù‡Ø§ Ø¨Ù„Ø§ ØªØºÙŠÙŠØ± ÙƒØ¨ÙŠØ±.
    </div>
  </div>

  <!-- CONTENT -->
  <div class="grid two">
    <div class="caps">
      <div class="cap">
        <div class="capLeft">
          <div class="iconBubble iconPoints">ğŸ’ </div>
          <div class="capText">
            <div class="t">Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø§Ø·</div>
            <div class="v" id="points">0</div>
          </div>
        </div>
        <div style="font-weight:900;opacity:.9">Points</div>
      </div>

      <div class="cap">
        <div class="capLeft">
          <div class="iconBubble iconDone">âœ…</div>
          <div class="capText">
            <div class="t">Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©</div>
            <div class="v" id="done">0</div>
          </div>
        </div>
        <div style="font-weight:900;opacity:.9">Done</div>
      </div>

      <div class="cap">
        <div class="capLeft">
          <div class="iconBubble iconTasks">ğŸ“Œ</div>
          <div class="capText">
            <div class="t">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù‡Ø§Ù…</div>
            <div class="v" id="total">0</div>
          </div>
        </div>
        <div style="font-weight:900;opacity:.9">Total</div>
      </div>

      <button class="cta" onclick="location.href='/tasks'">Ø§Ù„Ø°Ù‡Ø§Ø¨ Ù„Ù„Ù…Ù‡Ø§Ù…</button>
    </div>

    <div class="infoCard">
      <div class="infoTitle">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨</div>

      <div class="row">
        <div class="k">Ø§Ù„Ø§Ø³Ù…</div>
        <div class="val" id="nameLine">â€”</div>
        <button class="copy" type="button" onclick="copyText('nameLine')">Ù†Ø³Ø®</button>
      </div>

      <div class="row">
        <div class="k">ID</div>
        <div class="val" id="idLine">â€”</div>
        <button class="copy" type="button" onclick="copyText('idLine')">Ù†Ø³Ø®</button>
      </div>

      <div class="row">
        <div class="k">Ø§Ù„Ø±ØµÙŠØ¯</div>
        <div class="val"><span id="pointsLine">0</span> Points</div>
        <button class="copy" type="button" onclick="copyPoints()">Ù†Ø³Ø®</button>
      </div>

      <div style="margin-top:10px;font-size:12px;color:var(--muted);line-height:1.6">
        Ø¥Ø°Ø§ Ø§Ø­ØªØ¬Øª ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±ØŒ ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù…Ù† ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ (Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±).
      </div>
    </div>
  </div>
</div>

<!-- NAV -->
<div class="nav">
  <div class="inner">
    <a href="/home" class="navbtn" id="navHome">
      <span class="icoNav">ğŸ </span><span class="txtNav">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
    </a>

    <a href="/tasks" class="navbtn" id="navTasks">
      <span class="icoNav">âœ…</span><span class="txtNav">Ø§Ù„Ù…Ù‡Ø§Ù…</span>
    </a>

    <a href="/profile" class="navbtn" id="navProfile">
      <span class="icoNav">ğŸ‘¤</span><span class="txtNav">Ø¨Ø±ÙˆÙØ§ÙŠÙ„</span>
    </a>

    <form method="post" action="/logout">
      <button type="submit" class="navbtn danger">
        <span class="icoNav">ğŸšª</span><span class="txtNav">Ø®Ø±ÙˆØ¬</span>
      </button>
    </form>
  </div>
</div>

<script src="/public/app.js"></script>
<script>
  function toast(msg){
    const t=document.getElementById("toast");
    t.textContent=msg;
    t.classList.add("show");
    setTimeout(()=>t.classList.remove("show"),2600);
  }

  function initials(name){
    const s=(name||"").trim();
    if(!s) return "U";
    const parts = s.split(/\s+/).filter(Boolean);
    const a = parts[0]?.[0] || "U";
    const b = parts[1]?.[0] || "";
    return (a + b).toUpperCase();
  }

  function copyText(id){
    const v = (document.getElementById(id)?.textContent || "").trim();
    if(!v){ toast("Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø´ÙŠØ¡ Ù„Ù„Ù†Ø³Ø®"); return; }
    navigator.clipboard?.writeText(v);
    toast("ØªÙ… Ø§Ù„Ù†Ø³Ø® âœ…");
  }
  function copyPoints(){
    const v = (document.getElementById("pointsLine")?.textContent || "").trim();
    navigator.clipboard?.writeText(v);
    toast("ØªÙ… Ø§Ù„Ù†Ø³Ø® âœ…");
  }

  (function setActiveNav(){
    const p = location.pathname;
    const home = document.getElementById("navHome");
    const tasks = document.getElementById("navTasks");
    const prof = document.getElementById("navProfile");
    if(home && (p==="/home" || p==="/")) home.classList.add("active");
    if(tasks && p==="/tasks") tasks.classList.add("active");
    if(prof && p==="/profile") prof.classList.add("active");
  })();

  async function load(){
    try{
      const me = await api("/api/me");

      const full = me.user?.full_name || "User";
      const id = String(me.user?.id || "â€”");

      document.getElementById("fullName").textContent = full;
      document.getElementById("avatar").textContent = initials(full);

      document.getElementById("subLine").textContent =
        "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨ + Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„ÙŠÙˆÙ…ÙŠØ© ÙÙŠ ÙˆØ§Ø¬Ù‡Ø© Ø²Ø¬Ø§Ø¬ÙŠØ© Ø£Ù†ÙŠÙ‚Ø©.";

      document.getElementById("uid").textContent = id;

      const pts = me.user?.points_balance ?? 0;
      document.getElementById("points").textContent = pts;
      document.getElementById("done").textContent = me.tasks?.done ?? 0;
      document.getElementById("total").textContent = me.tasks?.total ?? 0;

      document.getElementById("nameLine").textContent = full;
      document.getElementById("idLine").textContent = id;
      document.getElementById("pointsLine").textContent = pts;

      document.getElementById("status").textContent = "Active";
    }catch(e){
      toast(e?.message || "ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
      document.getElementById("subLine").textContent = "ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª";
    }
  }

  load();
</script>

</body>
</html>